# triple-secure

## Problem Statement

To get the flag, you must break RSA not once, but three times!

[public-key.txt](./public-key.txt)

[encrypt.py](./encrypt.py)

## Information

**Category**: Cryptography

**Difficulty**: Hard

## Hints

None

## Solution

We are given the file public-key.txt, which has contents:
```
n1: 15192492059814175574941055248891268822162533520576381643453916855435310880285336743521199057138647926712835561752909538944229702432795423884081992987060760867003375755338557996965825324749221386675061886921763747311599846248565297387814717840084998677273427776535730840343260681623323972936404815862969684384733188827100528542007213405382537935243645704237369770300643318878176739181891072725262069278646319502747718264711249767568106460533935904219027313131270918072460753061248221785076571054217566164086518459844527639082962818865640864990672033657423448004651989761933295878220596871163544315057550871764431562609
n2: 15896482259608901559307142941940447232781986632502572991096358742354276347180855512281737388865155342941898447990281534875563129451327818848218781669275420292448483501384399236235069545630630803245125324540747189305877026874280373084005881976783826855683894679886076284892158862128016644725623200756074647449586448311069649515124968073653962156220351541159266665209363921681260367806445996085898841723209546021525012849575330252109081102034217511126192041193752164593519033112893785698509908066978411804133407757110693612926897693360335062446358344787945536573595254027237186626524339635916646549827668224103778645691
n3: 16866741024290909515057727275216398505732182398866918550484373905882517578053919415558082579015872872951000794941027637288054371559194213756955947899010737036612882434425333227722062177363502202508368233645194979635011153509966453453939567651558628538264913958577698775210185802686516291658717434986786180150155217870273053289491069438118831268852205061142773994943387097417127660301519478434586738321776681183207796708047183864564628638795241493797850819727510884955449295504241048877759144706319821139891894102191791380663609673212846473456961724455481378829090944739778647230176360232323776623751623188480059886131
e: 65537
c: 5527557130549486626868355638343164556636640645975070563878791684872084568660950949839392805902757480207470630636669246237037694811318758082850684387745430679902248681495009593699928689084754915870981630249821819243308794164014262751330197659053593094226287631278905866187610594268602850237495796773397013150811502709453828013939726304717253858072813654392558403246468440154864433527550991691477685788311857169847773031859714215539719699781912119479668386111728900692806809163838659848295346731226661208367992168348253106720454566346143578242135426677554444162371330348888185625323879290902076363791018691228620744490
```

looking through the provided encrypt.py file, we understand that n1 = p * q, n2 = p * r, n3 = q * r,
so we can try to factor and solve to find p, q, or r.

factoring n1 using tools such as [this website](https://factordb.com/), we get (p * q):
`119660120407416342093521198875970200503652030026184999838840951544471188235057764512149622436334754517070092115889922087976143409261665862157884453930404483415351610238154321433871054239568905273137919725917526056473901359312949883646592913381637999260828599289383860301717085920912559762712295164989106012643` and
`126963703597214242111055793388455179890379067770512076858587717197146928847759121114335398860091528260297687323794942479532566444647858389461128295471609299505781851499310733099158304584543771415239918097328230929655601250453281393102266829307661217314893414986784482323832179578849867366834284687012845412763`

factoring n2, we get (p * r):
`119660120407416342093521198875970200503652030026184999838840951544471188235057764512149622436334754517070092115889922087976143409261665862157884453930404483415351610238154321433871054239568905273137919725917526056473901359312949883646592913381637999260828599289383860301717085920912559762712295164989106012643` and `132846951895793538897077555403967847542050766700952197146228251113081712319440889155149846202888542648969351063239105740434095718011829001684551658508591803707420131965877374781379009502046474415909376904718002094203010990824838428607725944298259738507797326637681632441750845743202171364832477389321609195337`

since the first factor is the same, we understand that it must be p, and thus we have q and r as well.

plugging all these values into [a decryptor](https://www.dcode.fr/rsa-cipher) and decrypting n3 with q and r, we get
`12431698776462604664330272930434817031149053664745413512190397138653600379187996414604160082217150862538818398668920659243509226750285667906986677414748705986117552073294027379821479073430580976414233893262855151479060589387329471980499403510783826089615622767412349340731943524227935915934933951984802023805729649975565534541912607042710730173769723959925423021014360768393947661711311800236169860255652833842765951346899344010017540746614687496753657731376890635124922889621046993760576174932225049947987925915462804250263449109193389185911806692168605680398138400109051488769387723844659740258581719720024154340058`
we know that this is the ciphertext before encrypting with n3, so we treat this as the new ciphertext and continue (*if this is confusing, check out how [this resource](https://brilliant.org/wiki/rsa-encryption/) on RSA!*) 


decrypting this ciphertext along with n2 with p and r, we get 
`1220881067127251830746330396398773442010532469491795088323996553735065195668358201811362735351239314724065034545554894603240189740556231877459625582529141060691215896980113075789130218748969619057345860607555869205346500037360537076979506014291481205727038654628087822258529493687855338245983554736723710206558302790339637741245297520084621812451959785143693437337203750684222728727843159664909385097986675169148907629497787907117383196156383853160140445656800246298652121758605529759589846232609174593031688324121000879670299943928891789005703257254083937430121315971315554375573431549884698724569188965976102215489`

decrypting this ciphertext along with n1, p and q, we finally get the key:
```
picoCTF{1_gu3ss_tr1pl3_rs4_1snt_tr1pl3_s3cur3!!!!!!}
```

## Flag

picoCTF{1_gu3ss_tr1pl3_rs4_1snt_tr1pl3_s3cur3!!!!!!}
